<!DOCTYPE html>
<html lang="{{ site.lang | default: "pt-BR" }}">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{ page.title | default: site.title }}</title>
    <meta name="description" content="{{ page.description | default: site.description }}">
{% seo %}
    
    <!-- Mermaid JS for diagrams - CDN approach (GitHub Pages compatible) -->
    <script type="module">
      import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
      
      // Convert markdown code blocks to mermaid divs
      document.addEventListener('DOMContentLoaded', function() {
        // Find all code blocks with language-mermaid class
        const mermaidBlocks = document.querySelectorAll('pre code.language-mermaid');
        
        mermaidBlocks.forEach((block) => {
          // Create a new div with mermaid class
          const mermaidDiv = document.createElement('div');
          mermaidDiv.className = 'mermaid';
          mermaidDiv.textContent = block.textContent;
          
          // Replace the pre/code structure with the div
          block.parentElement.replaceWith(mermaidDiv);
        });
        
        // Initialize Mermaid after conversion
        mermaid.initialize({ 
          startOnLoad: true,
          theme: 'default',
          securityLevel: 'loose',
          fontFamily: 'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'
        });
        
        // Manually render all mermaid elements
        mermaid.run();
      });
      
      // Auto-convert bare URLs to clickable links (fallback)
      document.addEventListener('DOMContentLoaded', function() {
        const urlPattern = /(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim;
        
        function linkifyNode(node) {
          if (node.nodeType === 3) { // Text node
            const text = node.textContent;
            if (urlPattern.test(text)) {
              const span = document.createElement('span');
              span.innerHTML = text.replace(urlPattern, '<a href="$1" target="_blank" rel="noopener noreferrer">$1</a>');
              node.parentNode.replaceChild(span, node);
            }
          } else if (node.nodeType === 1 && node.nodeName !== 'A' && node.nodeName !== 'SCRIPT' && node.nodeName !== 'STYLE') {
            for (let i = 0; i < node.childNodes.length; i++) {
              linkifyNode(node.childNodes[i]);
            }
          }
        }
        
        // Apply to main content
        const mainContent = document.querySelector('.main-content');
        if (mainContent) {
          linkifyNode(mainContent);
        }
      });
    </script>
    
    <!-- Minimal, clean styles for whitepaper -->
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
        line-height: 1.6;
        color: #24292e;
        background: #ffffff;
      }
      
      /* Simple header */
      .site-header {
        background: #f6f8fa;
        border-bottom: 1px solid #e1e4e8;
        padding: 1.5rem 0;
        margin-bottom: 2rem;
      }
      
      .site-header .container {
        max-width: 900px;
        margin: 0 auto;
        padding: 0 20px;
      }
      
      .site-title {
        font-size: 1.5rem;
        font-weight: 600;
        color: #24292e;
        margin: 0;
      }
      
      .site-description {
        font-size: 1rem;
        color: #586069;
        margin: 0.25rem 0 0 0;
      }
      
      .github-link {
        margin-top: 0.5rem;
        font-size: 0.9rem;
      }
      
      .github-link a {
        color: #0366d6;
        text-decoration: none;
        border-bottom: 1px solid transparent;
        transition: all 0.2s ease;
      }
      
      .github-link a:hover {
        border-bottom: 1px solid #0366d6;
      }
      
      /* Main content */
      .main-content {
        max-width: 900px;
        margin: 0 auto;
        padding: 0 20px 3rem 20px;
        font-size: 16px;
        line-height: 1.7;
      }
      
      /* Typography */
      .main-content h1 {
        margin-top: 2rem;
        margin-bottom: 1rem;
        border-bottom: 2px solid #0366d6;
        padding-bottom: 0.5rem;
        font-size: 2rem;
        font-weight: 600;
      }
      
      .main-content h2 {
        margin-top: 2.5rem;
        margin-bottom: 1rem;
        color: #0366d6;
        font-size: 1.5rem;
        font-weight: 600;
      }
      
      .main-content h3 {
        margin-top: 2rem;
        margin-bottom: 0.75rem;
        font-size: 1.25rem;
        font-weight: 600;
      }
      
      .main-content h4 {
        margin-top: 1.5rem;
        margin-bottom: 0.5rem;
        font-size: 1.1rem;
        font-weight: 600;
      }
      
      .main-content p {
        margin: 1rem 0;
      }
      
      /* Links - make them obviously clickable */
      .main-content a {
        color: #0366d6;
        text-decoration: none;
        border-bottom: 1px solid transparent;
        transition: all 0.2s ease;
      }
      
      .main-content a:hover {
        color: #0366d6;
        border-bottom: 1px solid #0366d6;
      }
      
      .main-content a:visited {
        color: #6f42c1;
      }
      
      /* Code blocks */
      .main-content pre {
        background-color: #f6f8fa;
        border: 1px solid #d1d5da;
        border-radius: 6px;
        padding: 16px;
        overflow: auto;
        font-size: 14px;
        line-height: 1.45;
      }
      
      .main-content code {
        background-color: #f6f8fa;
        padding: 0.2em 0.4em;
        border-radius: 3px;
        font-size: 90%;
      }
      
      .main-content pre code {
        background-color: transparent;
        padding: 0;
        font-size: 100%;
      }
      
      /* Tables */
      .main-content table {
        width: 100%;
        margin: 1.5rem 0;
        border-collapse: collapse;
        font-size: 14px;
      }
      
      .main-content table th,
      .main-content table td {
        padding: 12px 15px;
        border: 1px solid #d1d5da;
      }
      
      .main-content table th {
        background-color: #159957;
        color: white;
        font-weight: 600;
      }
      
      .main-content table tr:nth-child(even) {
        background-color: #f6f8fa;
      }
      
      /* Mermaid diagrams */
      .mermaid {
        text-align: center;
        margin: 2rem 0;
        background-color: #fff;
        padding: 20px;
        border-radius: 6px;
        border: 1px solid #e1e4e8;
      }
      
      /* Blockquotes for definitions */
      .main-content blockquote {
        background-color: #fff5e6;
        border-left: 4px solid #ff9800;
        padding: 1rem 1.5rem;
        margin: 1.5rem 0;
        font-style: italic;
      }
      
      /* Better spacing for lists */
      .main-content ul,
      .main-content ol {
        margin: 1rem 0;
        padding-left: 2rem;
      }
      
      .main-content li {
        margin: 0.5rem 0;
      }
      
      /* Print styles */
      @media print {
        .page-header {
          display: none;
        }
        
        .main-content {
          max-width: 100%;
        }
        
        .mermaid {
          break-inside: avoid;
        }
      }
    </style>
  </head>
  <body>
    <!-- Simple minimal header -->
    <header class="site-header">
      <div class="container">
        <h1 class="site-title">{{ page.title | default: site.title }}</h1>
        <p class="site-description">{{ page.description | default: site.description }}</p>
        {% if site.github.is_project_page %}
        <p class="github-link">
          <a href="{{ site.github.repository_url }}">üìù Contribua para o whitepaper no GitHub</a>
        </p>
        {% endif %}
      </div>
    </header>

    <!-- Main content -->
    <main class="main-content">
      {{ content }}
      
      <!-- Simple footer -->
      <footer style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid #e1e4e8; color: #586069; font-size: 0.9rem;">
        <p>
          Licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> | 
          Published by <a href="https://techleads.club">TechLeads.club</a>
          {% if site.github.is_project_page %}
          | <a href="{{ site.github.repository_url }}">GitHub</a>
          {% endif %}
        </p>
      </footer>
    </main>
  </body>
</html>

